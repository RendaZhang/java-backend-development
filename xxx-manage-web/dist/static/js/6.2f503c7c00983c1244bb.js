webpackJsonp([6],{"3C/1":function(t,e,s){s("M6a0"),s("zQR9"),s("+tPU"),s("qCoq"),s("UvrK"),s("Xjd4"),s("bqnK"),t.exports=s("FeBl").Map},"4WTo":function(t,e,s){var i=s("NWt+");t.exports=function(t,e){var s=[];return i(t,!1,s.push,s,e),s}},"5PlU":function(t,e,s){var i=s("RY/4"),n=s("dSzd")("iterator"),r=s("/bQp");t.exports=s("FeBl").isIterable=function(t){var e=Object(t);return void 0!==e[n]||"@@iterator"in e||r.hasOwnProperty(i(e))}},"7Doy":function(t,e,s){var i=s("EqjI"),n=s("7UMu"),r=s("dSzd")("species");t.exports=function(t){var e;return n(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!n(e.prototype)||(e=void 0),i(e)&&null===(e=e[r])&&(e=void 0)),void 0===e?Array:e}},"9Bbf":function(t,e,s){"use strict";var i=s("kM2E");t.exports=function(t){i(i.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},"9C8M":function(t,e,s){"use strict";var i=s("evD5").f,n=s("Yobk"),r=s("xH/j"),o=s("+ZMJ"),a=s("2KxR"),c=s("NWt+"),u=s("vIB/"),l=s("EGZi"),d=s("bRrM"),p=s("+E39"),f=s("06OY").fastKey,v=s("LIJb"),h=p?"_s":"size",m=function(t,e){var s,i=f(e);if("F"!==i)return t._i[i];for(s=t._f;s;s=s.n)if(s.k==e)return s};t.exports={getConstructor:function(t,e,s,u){var l=t(function(t,i){a(t,l,e,"_i"),t._t=e,t._i=n(null),t._f=void 0,t._l=void 0,t[h]=0,void 0!=i&&c(i,s,t[u],t)});return r(l.prototype,{clear:function(){for(var t=v(this,e),s=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete s[i.i];t._f=t._l=void 0,t[h]=0},delete:function(t){var s=v(this,e),i=m(s,t);if(i){var n=i.n,r=i.p;delete s._i[i.i],i.r=!0,r&&(r.n=n),n&&(n.p=r),s._f==i&&(s._f=n),s._l==i&&(s._l=r),s[h]--}return!!i},forEach:function(t){v(this,e);for(var s,i=o(t,arguments.length>1?arguments[1]:void 0,3);s=s?s.n:this._f;)for(i(s.v,s.k,this);s&&s.r;)s=s.p},has:function(t){return!!m(v(this,e),t)}}),p&&i(l.prototype,"size",{get:function(){return v(this,e)[h]}}),l},def:function(t,e,s){var i,n,r=m(t,e);return r?r.v=s:(t._l=r={i:n=f(e,!0),k:e,v:s,p:i=t._l,n:void 0,r:!1},t._f||(t._f=r),i&&(i.n=r),t[h]++,"F"!==n&&(t._i[n]=r)),t},getEntry:m,setStrong:function(t,e,s){u(t,e,function(t,s){this._t=v(t,e),this._k=s,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?l(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,l(1))},s?"entries":"values",!s,!0),d(e)}}},ALrJ:function(t,e,s){var i=s("+ZMJ"),n=s("MU5D"),r=s("sB3e"),o=s("QRG4"),a=s("oeOm");t.exports=function(t,e){var s=1==t,c=2==t,u=3==t,l=4==t,d=6==t,p=5==t||d,f=e||a;return function(e,a,v){for(var h,m,g=r(e),x=n(g),_=i(a,v,3),b=o(x.length),k=0,y=s?f(e,b):c?f(e,0):void 0;b>k;k++)if((p||k in x)&&(m=_(h=x[k],k,g),t))if(s)y[k]=m;else if(m)switch(t){case 3:return!0;case 5:return h;case 6:return k;case 2:y.push(h)}else if(l)return!1;return d?-1:u||l?l:y}}},Cdx3:function(t,e,s){var i=s("sB3e"),n=s("lktj");s("uqUo")("keys",function(){return function(t){return n(i(t))}})},HpRW:function(t,e,s){"use strict";var i=s("kM2E"),n=s("lOnJ"),r=s("+ZMJ"),o=s("NWt+");t.exports=function(t){i(i.S,t,{from:function(t){var e,s,i,a,c=arguments[1];return n(this),(e=void 0!==c)&&n(c),void 0==t?new this:(s=[],e?(i=0,a=r(c,arguments[2],2),o(t,!1,function(t){s.push(a(t,i++))})):o(t,!1,s.push,s),new this(s))}})}},LIJb:function(t,e,s){var i=s("EqjI");t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},S6ft:function(t,e){},TmV0:function(t,e,s){s("fZOM"),t.exports=s("FeBl").Object.values},UvrK:function(t,e,s){var i=s("kM2E");i(i.P+i.R,"Map",{toJSON:s("m9gC")("Map")})},Xd32:function(t,e,s){s("+tPU"),s("zQR9"),t.exports=s("5PlU")},Xjd4:function(t,e,s){s("9Bbf")("Map")},bqnK:function(t,e,s){s("HpRW")("Map")},d7EF:function(t,e,s){"use strict";e.__esModule=!0;var i=r(s("us/S")),n=r(s("BO1k"));function r(t){return t&&t.__esModule?t:{default:t}}e.default=function(){return function(t,e){if(Array.isArray(t))return t;if((0,i.default)(Object(t)))return function(t,e){var s=[],i=!0,r=!1,o=void 0;try{for(var a,c=(0,n.default)(t);!(i=(a=c.next()).done)&&(s.push(a.value),!e||s.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&c.return&&c.return()}finally{if(r)throw o}}return s}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},fZOM:function(t,e,s){var i=s("kM2E"),n=s("mbce")(!1);i(i.S,"Object",{values:function(t){return n(t)}})},fZjL:function(t,e,s){t.exports={default:s("jFbC"),__esModule:!0}},gRE1:function(t,e,s){t.exports={default:s("TmV0"),__esModule:!0}},ifoU:function(t,e,s){t.exports={default:s("3C/1"),__esModule:!0}},jFbC:function(t,e,s){s("Cdx3"),t.exports=s("FeBl").Object.keys},m9gC:function(t,e,s){var i=s("RY/4"),n=s("4WTo");t.exports=function(t){return function(){if(i(this)!=t)throw TypeError(t+"#toJSON isn't generic");return n(this)}}},mWTg:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("fZjL"),n=s.n(i),r=s("ifoU"),o=s.n(r),a=s("woOf"),c=s.n(a),u=s("mvHQ"),l=s.n(u),d=s("gRE1"),p=s.n(d),f=s("+6Bu"),v=s.n(f),h=s("d7EF"),m=s.n(h),g={name:"goods-form",props:{oldGoods:{type:Object},isEdit:{type:Boolean,default:!1},step:{type:Number,default:1}},data:function(){return{valid:!1,goods:{categories:[],brandId:0,title:"",subTitle:"",spuDetail:{packingList:"",afterService:"",description:""}},brandOptions:[],specs:[],specialSpecs:[]}},methods:{submit:function(){var t=this;this.$refs.basic.validate||this.$message.error("请先完成表单内容！");var e=this.goods,s=m()(e.categories,3),i=s[0].id,n=s[1].id,r=s[2].id,o=v()(e,["categories"]),a={};this.specs.forEach(function(t){var e=t.id,s=t.v;a[e]=s});var u={};this.specialSpecs.forEach(function(t){var e=t.id,s=t.options;u[e]=s});var d=this.skus.filter(function(t){return t.enable}).map(function(e){var s=e.price,i=e.stock,n=e.enable,r=e.images,a=e.indexes,c=v()(e,["price","stock","enable","images","indexes"]),u=o.title+" "+p()(c).map(function(t){return t.v}).join(" "),d={};return p()(c).forEach(function(t){d[t.id]=t.v}),{price:t.$format(s),stock:i,indexes:a,enable:n,title:u,images:r?r.join(","):"",ownSpec:l()(d)}});c()(o,{cid1:i,cid2:n,cid3:r,skus:d}),o.spuDetail.genericSpec=l()(a),o.spuDetail.specialSpec=l()(u),this.$http({method:this.isEdit?"put":"post",url:"/item/goods",data:o}).then(function(){t.$emit("close"),t.$message.success("保存成功了")}).catch(function(){t.$message.error("保存失败！")})}},watch:{oldGoods:{deep:!0,handler:function(t){if(this.isEdit){this.goods=Object.deepCopy(t);var e=t.cname.split("/");this.goods.categories=[{id:t.cid1,name:e[0]},{id:t.cid2,name:e[1]},{id:t.cid3,name:e[2]}];var s=new o.a;this.goods.skus.forEach(function(t){s.set(t.indexes,t)}),this.goods.skus=s}else c()(this.goods,{categories:null,brandId:0,title:"",subTitle:"",spuDetail:{packingList:"",afterService:"",description:""}}),this.specs=[],this.specialSpecs=[]}},"goods.categories":{deep:!0,handler:function(t){var e=this;t&&t.length>0&&(this.$http.get("/item/brand/cid/"+this.goods.categories[2].id).then(function(t){var s=t.data;e.brandOptions=s}),this.$http.get("/item/spec/params?cid="+this.goods.categories[2].id).then(function(t){var s=t.data,i=[],n=[];e.isEdit&&(i=JSON.parse(e.goods.spuDetail.genericSpec),n=JSON.parse(e.goods.spuDetail.specialSpec));var r=[],o=[];s.forEach(function(t){var s=t.id,a=t.name,c=t.generic,u=t.numeric,l=t.unit;if(c){var d={id:s,name:a,numeric:u,unit:l};e.isEdit&&(d.v=i[s]),r.push(d)}else{var p={id:s,name:a,options:[]};e.isEdit&&(p.options=n[s]),o.push(p)}}),e.specs=r,e.specialSpecs=o}))}}},computed:{skus:function(){var t=this,e=this.specialSpecs.filter(function(t){return t.options.length>0});return e.reduce(function(s,i,n){var r=[];return s.forEach(function(s){i.options.forEach(function(o,a){var u=JSON.parse(l()(s));if(u[i.name]={v:o,id:i.id},u.indexes=(u.indexes||"")+"_"+a,n===e.length-1&&(u.indexes=u.indexes.substring(1),c()(u,{price:0,stock:0,enable:!1,images:[]}),t.isEdit)){var d=t.goods.skus.get(u.indexes);if(null!=d){var p=d.price,f=d.stock,v=d.enable,h=d.images;c()(u,{price:t.$format(p),stock:f,enable:v,images:h?h.split(","):[]})}}r.push(u)})}),r},[{}])},headers:function(){if(this.skus.length<=0)return[];var t=[];return n()(this.skus[0]).forEach(function(e){var s=e;if("price"===e)e="价格";else if("stock"===e)e="库存";else if("enable"===e)e="是否启用";else if("images"===e||"indexes"===e)return;t.push({text:e,align:"center",sortable:!1,value:s})}),t}}},x={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-stepper",{model:{value:t.step,callback:function(e){t.step=e},expression:"step"}},[s("v-stepper-header",[s("v-stepper-step",{attrs:{complete:t.step>1,step:"1"}},[t._v("基本信息")]),t._v(" "),s("v-divider"),t._v(" "),s("v-stepper-step",{attrs:{complete:t.step>2,step:"2"}},[t._v("商品描述")]),t._v(" "),s("v-divider"),t._v(" "),s("v-stepper-step",{attrs:{complete:t.step>3,step:"3"}},[t._v("规格参数")]),t._v(" "),s("v-divider"),t._v(" "),s("v-stepper-step",{attrs:{step:"4"}},[t._v("SKU属性")])],1),t._v(" "),s("v-stepper-items",[s("v-stepper-content",{attrs:{step:"1"}},[s("v-flex",{staticClass:"xs10 mx-auto"},[s("v-form",{ref:"basic",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[s("v-layout",{attrs:{row:""}},[s("v-flex",{attrs:{xs5:""}},[s("v-cascader",{attrs:{url:"/item/category/list",required:"",showAllLevels:"",label:"请选择商品分类"},model:{value:t.goods.categories,callback:function(e){t.$set(t.goods,"categories",e)},expression:"goods.categories"}})],1),t._v(" "),s("v-spacer"),t._v(" "),s("v-flex",{attrs:{xs5:""}},[s("v-select",{attrs:{items:t.brandOptions,"item-text":"name","item-value":"id",label:"所属品牌",required:"",autocomplete:"",clearable:"",dense:"",chips:"",rules:[function(t){return!!t||"品牌不能为空"}]},scopedSlots:t._u([{key:"selection",fn:function(e){return[s("v-chip",{attrs:{small:""}},[t._v(t._s(e.item.name))])]}}]),model:{value:t.goods.brandId,callback:function(e){t.$set(t.goods,"brandId",e)},expression:"goods.brandId"}})],1)],1),t._v(" "),s("v-text-field",{attrs:{label:"商品标题",counter:200,required:"",rules:[function(t){return!!t||"商品标题不能为空"}],"hide-details":""},model:{value:t.goods.title,callback:function(e){t.$set(t.goods,"title",e)},expression:"goods.title"}}),t._v(" "),s("v-text-field",{attrs:{label:"商品卖点",counter:200,"hide-details":""},model:{value:t.goods.subTitle,callback:function(e){t.$set(t.goods,"subTitle",e)},expression:"goods.subTitle"}}),t._v(" "),s("v-text-field",{attrs:{label:"包装清单",counter:1e3,"multi-line":"",rows:3,"hide-details":""},model:{value:t.goods.spuDetail.packingList,callback:function(e){t.$set(t.goods.spuDetail,"packingList",e)},expression:"goods.spuDetail.packingList"}}),t._v(" "),s("v-text-field",{attrs:{label:"售后服务",counter:1e3,"multi-line":"",rows:3,"hide-details":""},model:{value:t.goods.spuDetail.afterService,callback:function(e){t.$set(t.goods.spuDetail,"afterService",e)},expression:"goods.spuDetail.afterService"}})],1)],1)],1),t._v(" "),s("v-stepper-content",{attrs:{step:"2"}},[s("v-editor",{attrs:{"upload-url":"/upload/image"},model:{value:t.goods.spuDetail.description,callback:function(e){t.$set(t.goods.spuDetail,"description",e)},expression:"goods.spuDetail.description"}})],1),t._v(" "),s("v-stepper-content",{attrs:{step:"3"}},[s("v-flex",{staticClass:"xs10 mx-auto px-3"},[s("v-card",{staticClass:"my-2"},[s("v-container",{attrs:{"grid-list-md":"",fluid:""}},[s("v-layout",{staticClass:"px-5",attrs:{wrap:"",row:"","justify-space-between":""}},t._l(t.specs,function(e){return s("v-flex",{key:e.name,attrs:{xs12:"",sm5:""}},[s("v-text-field",{attrs:{label:e.name,suffix:e.unit||""},model:{value:e.v,callback:function(s){t.$set(e,"v",s)},expression:"param.v"}})],1)}))],1)],1)],1)],1),t._v(" "),s("v-stepper-content",{attrs:{step:"4"}},[s("v-flex",{staticClass:"mx-auto"},[t._l(t.specialSpecs,function(e){return s("v-card",{key:e.name,attrs:{flat:""}},[s("div",{staticClass:"subheading"},[t._v(t._s(e.name)+":")]),t._v(" "),s("v-card-text",{staticClass:"px-5"},t._l(e.options.length+1,function(i){return s("div",{key:i,staticClass:"layout row px-5"},[s("v-text-field",{staticClass:"flex xs10",attrs:{placeholder:"新的"+e.name+":","auto-grow":"",value:i,"single-line":"","hide-details":""},model:{value:e.options[i-1],callback:function(s){t.$set(e.options,i-1,s)},expression:"spec.options[i-1]"}}),t._v(" "),i<=e.options.length?s("v-btn",{attrs:{icon:""},on:{click:function(t){e.options.splice(i-1,1)}}},[s("i",{staticClass:"el-icon-delete"})]):t._e()],1)}))],1)}),t._v(" "),s("v-card",{staticClass:"elevation-0"},[s("div",{staticClass:"subheading py-3"},[t._v("SKU列表:")]),t._v(" "),s("v-divider"),t._v(" "),s("v-data-table",{staticClass:"elevation-0",attrs:{items:t.skus,headers:t.headers,"hide-actions":"","item-key":"indexes"},scopedSlots:t._u([{key:"items",fn:function(e){return[s("tr",{on:{click:function(t){e.expanded=!e.expanded}}},t._l(e.item,function(i,n){return["price","stock"].includes(n)?s("td",{key:n,staticClass:"text-xs-center"},[s("v-text-field",{attrs:{"single-line":""},on:{click:function(t){t.stopPropagation()}},model:{value:e.item[n],callback:function(s){t.$set(e.item,n,s)},expression:"props.item[k]"}})],1):"enable"===n?s("td",{staticClass:"text-xs-center"},[s("v-checkbox",{model:{value:e.item[n],callback:function(s){t.$set(e.item,n,s)},expression:"props.item[k]"}})],1):"images"!==n&&"indexes"!==n?s("td",{staticClass:"text-xs-center"},[t._v(t._s(i.v))]):t._e()}))]}},{key:"expand",fn:function(e){return[s("v-card",{staticClass:"elevation-2 flex xs11 mx-auto my-2"},[s("v-upload",{attrs:{url:"/upload/image"},model:{value:e.item.images,callback:function(s){t.$set(e.item,"images",s)},expression:"props.item.images"}})],1)]}}])})],1)],2),t._v(" "),s("v-flex",{attrs:{xs3:"","offset-xs9":""}},[s("v-btn",{attrs:{color:"info"},on:{click:t.submit}},[t._v("保存商品信息")])],1)],1)],1)],1)},staticRenderFns:[]};var _=s("VU/8")(g,x,!1,function(t){s("S6ft")},"data-v-a7bb08ea",null);e.default=_.exports},mbce:function(t,e,s){var i=s("lktj"),n=s("TcQ7"),r=s("NpIQ").f;t.exports=function(t){return function(e){for(var s,o=n(e),a=i(o),c=a.length,u=0,l=[];c>u;)r.call(o,s=a[u++])&&l.push(t?[s,o[s]]:o[s]);return l}}},oeOm:function(t,e,s){var i=s("7Doy");t.exports=function(t,e){return new(i(t))(e)}},qCoq:function(t,e,s){"use strict";var i=s("9C8M"),n=s("LIJb");t.exports=s("qo66")("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=i.getEntry(n(this,"Map"),t);return e&&e.v},set:function(t,e){return i.def(n(this,"Map"),0===t?0:t,e)}},i,!0)},qo66:function(t,e,s){"use strict";var i=s("7KvD"),n=s("kM2E"),r=s("06OY"),o=s("S82l"),a=s("hJx8"),c=s("xH/j"),u=s("NWt+"),l=s("2KxR"),d=s("EqjI"),p=s("e6n0"),f=s("evD5").f,v=s("ALrJ")(0),h=s("+E39");t.exports=function(t,e,s,m,g,x){var _=i[t],b=_,k=g?"set":"add",y=b&&b.prototype,E={};return h&&"function"==typeof b&&(x||y.forEach&&!o(function(){(new b).entries().next()}))?(b=e(function(e,s){l(e,b,t,"_c"),e._c=new _,void 0!=s&&u(s,g,e[k],e)}),v("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(t){var e="add"==t||"set"==t;t in y&&(!x||"clear"!=t)&&a(b.prototype,t,function(s,i){if(l(this,b,t),!e&&x&&!d(s))return"get"==t&&void 0;var n=this._c[t](0===s?0:s,i);return e?this:n})}),x||f(b.prototype,"size",{get:function(){return this._c.size}})):(b=m.getConstructor(e,t,g,k),c(b.prototype,s),r.NEED=!0),p(b,t),E[t]=b,n(n.G+n.W+n.F,E),x||m.setStrong(b,t,g),b}},uqUo:function(t,e,s){var i=s("kM2E"),n=s("FeBl"),r=s("S82l");t.exports=function(t,e){var s=(n.Object||{})[t]||Object[t],o={};o[t]=e(s),i(i.S+i.F*r(function(){s(1)}),"Object",o)}},"us/S":function(t,e,s){t.exports={default:s("Xd32"),__esModule:!0}}});
//# sourceMappingURL=6.2f503c7c00983c1244bb.js.map